import{_ as H,j as O,r as C,o as R,z as q,k as G,c as Y,A as J,B as K,a as B,b as s,d as a,C as m,s as $,g as n,h as c,t as l,q as T,D as P,f as Q,G as W,E as X,l as p,m as v,u as g,n as Z,F as ee,p as te,H as se,I as oe}from"./index-DJyl22Gq.js";import{d as ae}from"./marked.esm-DajSjiQI.js";import{a as ie}from"./article-D0gsV2vB.js";const ne={class:"article-detail-container"},le={class:"article-header"},re={class:"header-content"},ce={class:"meta-info"},de={class:"date"},ue={class:"title"},pe={class:"author-info"},ve={class:"views"},_e={class:"topic-content"},fe={class:"topic-name"},me={class:"topic-desc"},ge={class:"topic-stats"},ye={class:"topic-action"},he=["innerHTML"],ke={class:"article-footer"},be={class:"tags-list"},we={class:"actions"},Ae={class:"comments-section"},Ce={__name:"ArticleDetail",setup(Be){const D=O(),_=G(),y=D.params.id,{siteName:I,bannerSubtitle:N}=Q(),U=window.location.origin,o=C({id:y,title:"",category:"",createdAt:"",views:0,cover:"",tags:[],content:""}),f=C(!0),x=e=>{if(!e)return"";try{const t=new Date(e);if(isNaN(t.getTime()))return e;const r=t.getFullYear(),d=String(t.getMonth()+1).padStart(2,"0"),u=String(t.getDate()).padStart(2,"0");return`${r}-${d}-${u}`}catch{return typeof e=="string"&&/^\d{4}-\d{2}-\d{2}/.test(e)?e.split(" ")[0]||e.split("T")[0]:e}},j=async()=>{f.value=!0;try{const e=await ie({id:parseInt(y)});if(e){let t=[];e.tags&&(Array.isArray(e.tags)?t=e.tags:typeof e.tags=="string"&&(t=e.tags.split(",").map(d=>d.trim()).filter(d=>d))),o.value={id:e.id,title:e.title||"",category:e.categoryName||"",createdAt:x(e.createdAt),views:e.views||0,cover:e.coverImage||"https://picsum.photos/id/"+e.id+"/1200/600",tags:t,content:e.content||"",publishedByUser:e.publishedByUser||null,topic:e.topic||null,desc:e.desc||"",coverImage:e.coverImage||"",updatedAt:e.updatedAt||e.createdAt};const r=P({...e,tags:t,category:e.categoryName||""},I.value||"Blog System",N.value||"",U);W(r)}}catch(e){console.error("åŠ è½½æ–‡ç« å¤±è´¥:",e),X.error("åŠ è½½æ–‡ç« å¤±è´¥")}finally{f.value=!1}};R(()=>{j(),q(()=>{document.addEventListener("click",E)})});const E=e=>{const t=e.target.closest("a.topic-link");if(t){e.preventDefault();const r=t.getAttribute("data-topic-id");r&&_.push(`/topic/${r}`)}},h=e=>{e&&e.id&&_.push(`/author/${e.id}`)},z=e=>{if(e){const t=typeof e=="object"?e.slug:e;t&&_.push(`/tag/${t}`)}},k=()=>{o.value.topic&&o.value.topic.id&&_.push(`/topic/${o.value.topic.id}`)},L=Y(()=>{if(!o.value.content)return"";let e=ae.parse(o.value.content);return e=e.replace(/<a href="\/topic\/(\d+)"/g,'<a href="/topic/$1" class="topic-link" data-topic-id="$1"'),e});return(e,t)=>{var A;const r=c("el-tag"),d=c("el-avatar"),u=c("el-icon"),b=c("el-card"),w=c("el-button"),M=c("el-empty"),S=c("el-col"),V=c("el-row"),F=K("loading");return J((p(),B("div",ne,[s("div",le,[s("div",re,[s("div",ce,[a(r,{effect:"dark",round:"",class:"category-tag"},{default:n(()=>[v(l(o.value.category),1)]),_:1}),o.value.topic?(p(),m(r,{key:0,effect:"dark",round:"",class:"topic-tag",onClick:k},{default:n(()=>[v(" ğŸ“š "+l(o.value.topic.name),1)]),_:1})):$("",!0),s("span",de,l(o.value.createdAt),1)]),s("h1",ue,l(o.value.title),1),s("div",pe,[a(d,{size:32,src:((A=o.value.publishedByUser)==null?void 0:A.avatar)||"https://picsum.photos/id/64/100/100",onClick:t[0]||(t[0]=i=>h(o.value.publishedByUser)),style:{cursor:"pointer"}},null,8,["src"]),s("span",{class:"author-name",onClick:t[1]||(t[1]=i=>h(o.value.publishedByUser)),style:{cursor:"pointer"}},l(o.value.publishedByUser?o.value.publishedByUser.nickname||o.value.publishedByUser.username:"Admin"),1),t[2]||(t[2]=s("span",{class:"divider"},"Â·",-1)),t[3]||(t[3]=s("span",{class:"read-time"},"5 min read",-1)),t[4]||(t[4]=s("span",{class:"divider"},"Â·",-1)),s("span",ve,l(o.value.views)+" views",1)])]),s("div",{class:"header-image",style:T({backgroundImage:`url(${o.value.cover})`})},null,4)]),a(V,{justify:"center",class:"content-wrapper"},{default:n(()=>[a(S,{span:16,xs:22},{default:n(()=>[o.value.topic?(p(),m(b,{key:0,class:"topic-info-card",shadow:"never"},{default:n(()=>[s("div",{class:"topic-info",onClick:k},[t[7]||(t[7]=s("div",{class:"topic-icon"},"ğŸ“š",-1)),s("div",_e,[t[6]||(t[6]=s("div",{class:"topic-label"},"æœ¬æ–‡å±äºä¸“é¢˜",-1)),s("div",fe,l(o.value.topic.name),1),s("div",me,l(o.value.topic.description),1),s("div",ge,[s("span",null,l(o.value.topic.articleCount)+" ç¯‡æ–‡ç« ",1),t[5]||(t[5]=s("span",{class:"divider"},"Â·",-1)),s("span",null,l(o.value.topic.progress),1)])]),s("div",ye,[a(u,null,{default:n(()=>[a(g(Z))]),_:1})])])]),_:1})):$("",!0),a(b,{class:"content-card",shadow:"never"},{default:n(()=>[s("div",{class:"markdown-body",innerHTML:L.value},null,8,he),s("div",ke,[s("div",be,[(p(!0),B(ee,null,te(o.value.tags,i=>(p(),m(r,{key:typeof i=="object"?i.id:i,class:"tag-item",effect:"plain",style:T([typeof i=="object"&&i.color?{borderColor:i.color,color:i.color}:{},{cursor:"pointer"}]),onClick:$e=>z(i)},{default:n(()=>[v(" # "+l(typeof i=="object"?i.name:i),1)]),_:2},1032,["style","onClick"]))),128))]),s("div",we,[a(w,{type:"primary",plain:"",round:"",size:"small"},{default:n(()=>[a(u,null,{default:n(()=>[a(g(se))]),_:1}),t[8]||(t[8]=v(" ç‚¹èµ ",-1))]),_:1}),a(w,{round:"",size:"small"},{default:n(()=>[a(u,null,{default:n(()=>[a(g(oe))]),_:1}),t[9]||(t[9]=v(" åˆ†äº« ",-1))]),_:1})])])]),_:1}),s("div",Ae,[t[10]||(t[10]=s("h3",null,"è¯„è®º (0)",-1)),a(M,{description:"æš‚æ— è¯„è®ºï¼Œå¿«æ¥æŠ¢æ²™å‘å§ï¼"})])]),_:1})]),_:1})])),[[F,f.value]])}}},Ne=H(Ce,[["__scopeId","data-v-312f2352"]]);export{Ne as default};
