import{_ as ss,r as g,c as A,o as ts,w as V,a as v,b as e,d as i,e as es,u as _,f as as,t as r,g as d,h as f,E,i as os,j as ns,k as ls,l as p,m as k,n as is,F as S,p as z,q as rs,s as F,v as cs,x as ds,y as us}from"./index-Cyn0SW9k.js";import{g as j}from"./article-DKK3_dIc.js";import{g as vs}from"./tag-G6xbyobf.js";const ps={class:"home-container"},gs={class:"hero-section"},fs={class:"hero-content"},hs={class:"hero-title"},ms=["innerHTML"],_s={class:"hero-subtitle"},ks={class:"hero-actions"},ws={class:"article-list"},bs=["onClick"],ys=["src"],Cs={key:0,class:"article-cat-tag"},$s={class:"article-detail"},Is={class:"article-meta-top"},As={class:"date"},Ss={class:"views"},zs=["onClick"],Bs={class:"article-summary"},Ts={class:"article-footer"},Ms=["onClick"],Us={class:"pagination-wrapper"},xs={class:"sidebar-sticky"},Ns={key:0,class:"sidebar-widget profile-widget"},qs={class:"profile-content"},Ls=["src","alt"],Ds={class:"job-title"},Hs={class:"stats-row"},Vs={class:"sidebar-widget hot-widget"},Es={class:"hot-list"},Fs={class:"hot-number"},js={class:"hot-info"},Ps={class:"hot-text"},Gs={class:"hot-views"},Rs={class:"sidebar-widget tag-widget"},Ws={class:"tags-cloud"},Ys={__name:"Home",setup(Js){const B=ns(),w=ls(),T=g([]),b=g([]),M=g([]),y=g(1),U=g(10),x=g(0),h=g(0),o=g({username:"",nickname:"",avatar:""}),N=A(()=>!!localStorage.getItem("token")&&!!o.value.username),q=A(()=>o.value.nickname||o.value.username||"用户"),P=A(()=>o.value.avatar||""),L=async()=>{const t=localStorage.getItem("username"),s=localStorage.getItem("nickname"),l=localStorage.getItem("avatar");if(t&&(o.value.username=t,o.value.nickname=s||"",o.value.avatar=l||""),localStorage.getItem("token"))try{const u=await os();if(u){const c=u.user||u;o.value.username=c.username||t||"",o.value.nickname=c.nickname||s||"",o.value.avatar=c.avatar||l||"",c.username&&localStorage.setItem("username",c.username),c.nickname&&localStorage.setItem("nickname",c.nickname),c.avatar&&localStorage.setItem("avatar",c.avatar)}}catch(u){console.warn("获取用户信息失败:",u),!o.value.username&&t&&(o.value.username=t,o.value.nickname=s||"",o.value.avatar=l||"")}else o.value.username="",o.value.nickname="",o.value.avatar=""},{bannerTitle:G,bannerSubtitle:R}=as(),W=t=>{if(!t)return"";try{const s=new Date(t);if(isNaN(s.getTime()))return t;const l=s.getFullYear(),n=String(s.getMonth()+1).padStart(2,"0"),u=String(s.getDate()).padStart(2,"0");return`${l}-${n}-${u}`}catch{return typeof t=="string"&&/^\d{4}-\d{2}-\d{2}/.test(t)?t.split(" ")[0]||t.split("T")[0]:t}},Y=t=>{if(!t||t.trim()==="")return"分享编程心得<br>记录技术成长";if(t.includes(`
`))return t.replace(/\n/g,"<br>");if(t.length>10){const s=Math.floor(t.length/2);let l=s;for(let n=0;n<5;n++){if(t[s+n]===" "||t[s+n]==="，"||t[s+n]==="。"){l=s+n+1;break}if(t[s-n]===" "||t[s-n]==="，"||t[s-n]==="。"){l=s-n+1;break}}return t.substring(0,l)+"<br>"+t.substring(l)}return t},D=async()=>{try{const t=await j({page:y.value,size:U.value,status:"published"});b.value=(t.list||[]).map(s=>({id:s.id,title:s.title,desc:s.desc||"",category:s.categoryName||"",createdAt:W(s.createdAt),views:s.views||0,cover:s.coverImage||"https://picsum.photos/id/"+s.id+"/600/400",publishedByUser:s.publishedByUser||null})),x.value=t.total||0,M.value=b.value.slice(0,4).map(s=>({title:s.title,views:s.views>=1e3?(s.views/1e3).toFixed(1)+"k":s.views}))}catch(t){console.error("加载文章失败:",t),E.error("加载文章失败")}},J=async()=>{try{const t=await vs({page:1,size:20});T.value=(t.list||[]).slice(0,9).map(s=>s.name)}catch(t){console.error("加载标签失败:",t)}},C=async()=>{if(!localStorage.getItem("token")){h.value=0;return}try{const s=await j({page:1,size:1,status:"",onlyMine:!0});h.value=s.total||0}catch(s){console.error("加载我的文章数量失败:",s),h.value=0}},K=()=>{if(!localStorage.getItem("token")){E.warning("请先登录"),w.push("/login-new");return}w.push("/my-articles")};ts(()=>{D(),J(),L(),C()}),V(()=>B.path,()=>{B.path==="/"&&(L(),C())}),V(N,t=>{t?C():h.value=0});const O=()=>{document.getElementById("content-start").scrollIntoView({behavior:"smooth"})},Q=()=>{window.open("https://github.com/gogf/gf","_blank")},X=t=>{t&&t.id?w.push(`/author/${t.id}`):w.push("/about")};return(t,s)=>{const l=f("el-icon"),n=f("el-button"),u=f("el-avatar"),c=f("el-pagination"),H=f("el-col"),Z=f("el-row");return p(),v("div",ps,[e("div",gs,[s[7]||(s[7]=e("div",{class:"hero-bg-shape shape-1"},null,-1)),s[8]||(s[8]=e("div",{class:"hero-bg-shape shape-2"},null,-1)),e("div",fs,[e("h1",hs,[e("span",{class:"highlight",innerHTML:Y(_(G))},null,8,ms)]),e("p",_s,r(_(R)),1),e("div",ks,[i(n,{type:"primary",size:"large",round:"",class:"start-btn",onClick:O},{default:d(()=>[s[4]||(s[4]=k(" 开始阅读 ",-1)),i(l,{class:"el-icon--right"},{default:d(()=>[i(_(is))]),_:1})]),_:1}),i(n,{size:"large",round:"",class:"github-btn",onClick:Q},{default:d(()=>[i(l,{style:{"margin-right":"6px","font-size":"18px"}},{default:d(()=>[...s[5]||(s[5]=[e("svg",{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em"},[e("path",{fill:"currentColor",d:"M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"})],-1)])]),_:1}),s[6]||(s[6]=k(" GitHub ",-1))]),_:1})])]),s[9]||(s[9]=es('<div class="hero-illustration" data-v-cf79d315><div class="code-window" data-v-cf79d315><div class="window-header" data-v-cf79d315><div class="dot red" data-v-cf79d315></div><div class="dot yellow" data-v-cf79d315></div><div class="dot green" data-v-cf79d315></div></div><div class="window-body" data-v-cf79d315><div class="code-line" data-v-cf79d315><span class="keyword" data-v-cf79d315>package</span> main</div><div class="code-line" data-v-cf79d315> </div><div class="code-line" data-v-cf79d315><span class="keyword" data-v-cf79d315>import</span> (</div><div class="code-line indent" data-v-cf79d315><span class="string" data-v-cf79d315>&quot;fmt&quot;</span></div><div class="code-line indent" data-v-cf79d315><span class="string" data-v-cf79d315>&quot;github.com/gogf/gf/v2&quot;</span></div><div class="code-line" data-v-cf79d315>)</div><div class="code-line" data-v-cf79d315> </div><div class="code-line" data-v-cf79d315><span class="keyword" data-v-cf79d315>func</span> main() {</div><div class="code-line indent" data-v-cf79d315><span class="comment" data-v-cf79d315>// Start the journey</span></div><div class="code-line indent" data-v-cf79d315>fmt.Println(<span class="string" data-v-cf79d315>&quot;Hello, World!&quot;</span>)</div><div class="code-line" data-v-cf79d315>}</div></div></div></div>',1))]),i(Z,{gutter:40,class:"content-wrapper",id:"content-start"},{default:d(()=>[i(H,{span:16,xs:24,class:"main-column"},{default:d(()=>[e("div",ws,[(p(!0),v(S,null,z(b.value,(a,m)=>{var $;return p(),v("div",{key:a.id,class:"article-item",style:rs({animationDelay:`${m*.1}s`})},[e("div",{class:"article-thumb",onClick:I=>t.$router.push(`/article/${a.id}`)},[e("img",{src:a.cover,loading:"lazy"},null,8,ys),a.category?(p(),v("div",Cs,r(a.category),1)):F("",!0)],8,bs),e("div",$s,[e("div",Is,[e("span",As,[i(l,null,{default:d(()=>[i(_(cs))]),_:1}),k(" "+r(a.createdAt),1)]),e("span",Ss,[i(l,null,{default:d(()=>[i(_(ds))]),_:1}),k(" "+r(a.views),1)])]),e("h2",{class:"article-title",onClick:I=>t.$router.push(`/article/${a.id}`)},r(a.title),9,zs),e("p",Bs,r(a.desc),1),e("div",Ts,[e("div",{class:"author",onClick:us(I=>X(a.publishedByUser),["stop"])},[i(u,{size:24,src:(($=a.publishedByUser)==null?void 0:$.avatar)||"https://picsum.photos/id/64/100/100"},null,8,["src"]),e("span",null,r(a.publishedByUser?a.publishedByUser.nickname||a.publishedByUser.username:"Admin"),1)],8,Ms),i(n,{link:"",type:"primary",class:"read-more",onClick:I=>t.$router.push(`/article/${a.id}`)},{default:d(()=>[...s[10]||(s[10]=[k("阅读全文",-1)])]),_:1},8,["onClick"])])])],4)}),128))]),e("div",Us,[i(c,{background:"",layout:"prev, pager, next",total:x.value,"current-page":y.value,"page-size":U.value,onCurrentChange:s[0]||(s[0]=a=>{y.value=a,D()}),class:"pagination-responsive"},null,8,["total","current-page","page-size"])])]),_:1}),i(H,{span:8,xs:24,class:"sidebar-column"},{default:d(()=>[e("div",xs,[N.value?(p(),v("div",Ns,[s[14]||(s[14]=e("div",{class:"profile-bg"},null,-1)),e("div",qs,[e("div",{class:"profile-avatar",onClick:s[1]||(s[1]=a=>t.$router.push("/admin/profile"))},[e("img",{src:P.value||"https://picsum.photos/id/64/150/150",alt:q.value},null,8,Ls)]),e("h3",null,r(q.value),1),e("p",Ds,r(o.value.username||"Blog User"),1),s[13]||(s[13]=e("div",{class:"social-icons"},[e("a",{href:"https://github.com/gogf/gf",target:"_blank",class:"social-btn"},[e("i",{class:"fab fa-github"})]),e("a",{href:"https://twitter.com/golang",target:"_blank",class:"social-btn"},[e("i",{class:"fab fa-twitter"})])],-1)),e("div",Hs,[e("div",{class:"stat-item clickable",onClick:K},[e("strong",null,r(h.value),1),s[11]||(s[11]=e("span",null,"Articles",-1))]),s[12]||(s[12]=e("div",{class:"stat-item"},[e("strong",null,"0"),e("span",null,"Likes")],-1))])])])):F("",!0),e("div",Vs,[s[15]||(s[15]=e("h4",{class:"widget-title"},"热门文章",-1)),e("ul",Es,[(p(!0),v(S,null,z(M.value,(a,m)=>(p(),v("li",{key:m,class:"hot-item",onClick:s[2]||(s[2]=$=>t.$router.push("/article/1"))},[e("span",Fs,r(m+1),1),e("div",js,[e("div",Ps,r(a.title),1),e("span",Gs,r(a.views)+" reads",1)])]))),128))])]),e("div",Rs,[s[16]||(s[16]=e("h4",{class:"widget-title"},"标签",-1)),e("div",Ws,[(p(!0),v(S,null,z(T.value,a=>(p(),v("span",{key:a,class:"tag-chip",onClick:s[3]||(s[3]=m=>t.$router.push("/tag"))},r(a),1))),128))])])])]),_:1})]),_:1})])}}},Xs=ss(Ys,[["__scopeId","data-v-cf79d315"]]);export{Xs as default};
