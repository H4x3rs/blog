import{_ as K,c as z,j as O,r as d,o as W,E as D,k as q,w as G,A as H,B as J,a as u,b as s,d as o,h as n,t as r,g as c,ae as Q,l as i,C as X,s as C,m as w,u as A,O as Z,F as S,p as ee,v as te,x as se,Y as ae}from"./index-pI8Ea0fp.js";import{g as oe}from"./article-Drf1MOtL.js";const le={class:"author-articles-container"},ne={class:"author-header-section"},re={class:"header-content"},ce={class:"author-avatar-wrapper"},ie={class:"page-title"},de={class:"author-bio"},ue={class:"header-stats"},_e={class:"stat-item"},ve={class:"stat-value"},pe={class:"articles-header"},he={class:"section-title"},me={class:"count"},ge={key:1,class:"articles-list"},fe=["onClick"],ye={key:0,class:"article-cover"},we=["src","alt"],Ae={class:"article-content"},ke={class:"article-top"},be={class:"article-title"},xe={class:"article-summary"},De={class:"article-meta"},Ce={class:"meta-item"},Ie={class:"meta-item"},Ne={key:0,class:"meta-item"},Ve={key:2,class:"pagination-wrapper"},ze={__name:"AuthorArticles",setup(Be){const I=O(),N=q(),v=z(()=>parseInt(I.params.id)||0),p=d(!0),h=d([]),m=d(0),k=d(1),b=d(12),g=d("date"),f=d({id:0,name:"",avatar:"",bio:""}),B=e=>{if(!e)return"";try{const t=new Date(e);if(isNaN(t.getTime()))return e;const a=t.getFullYear(),_=String(t.getMonth()+1).padStart(2,"0"),y=String(t.getDate()).padStart(2,"0");return`${a}-${_}-${y}`}catch{return typeof e=="string"&&/^\d{4}-\d{2}-\d{2}/.test(e)?e.split(" ")[0]||e.split("T")[0]:e}},F=e=>e>=1e4?(e/1e4).toFixed(1)+"W":e>=1e3?(e/1e3).toFixed(1)+"K":e,V=async()=>{if(!v.value){D.error("作者ID无效");return}try{const e=await Q({id:v.value});e&&(f.value={id:e.id,name:e.nickname||e.username||"作者",avatar:e.avatar||"",bio:e.bio||""})}catch(e){console.error("加载作者信息失败:",e)}},x=async()=>{if(v.value){p.value=!0;try{const e={page:k.value,size:b.value,status:"published",authorId:v.value},t=await oe(e);h.value=(t.list||[]).map(a=>({id:a.id,title:a.title,summary:a.desc||"",cover:a.coverImage||"https://picsum.photos/id/"+a.id+"/400/300",createdAt:B(a.createdAt),views:a.views||0,category:a.categoryName||""})),m.value=t.total||0}catch(e){console.error("加载文章失败:",e),D.error("加载文章失败")}finally{p.value=!1}}},$=z(()=>{const e=[...h.value];return g.value==="date"?e.sort((t,a)=>new Date(a.createdAt)-new Date(t.createdAt)):g.value==="views"&&e.sort((t,a)=>a.views-t.views),e}),E=e=>{k.value=e,x()},M=e=>{N.push(`/article/${e.id}`)};return W(async()=>{if(!v.value){D.error("作者ID无效"),N.push("/");return}await V(),await x()}),G(()=>I.params.id,async e=>{e&&(await V(),await x())}),(e,t)=>{const a=n("el-avatar"),_=n("el-icon"),y=n("el-option"),T=n("el-select"),j=n("el-empty"),L=n("el-pagination"),P=n("el-card"),R=n("el-col"),U=n("el-row"),Y=J("loading");return H((i(),u("div",le,[s("div",ne,[t[2]||(t[2]=s("div",{class:"header-bg"},null,-1)),s("div",re,[s("div",ce,[o(a,{size:100,src:f.value.avatar||"https://picsum.photos/id/64/150/150"},null,8,["src"])]),s("h1",ie,r(f.value.name||"作者"),1),s("p",de,r(f.value.bio||"暂无简介"),1),s("div",ue,[s("div",_e,[s("span",ve,r(m.value),1),t[1]||(t[1]=s("span",{class:"stat-label"},"文章数",-1))])])])]),o(U,{justify:"center",class:"content-wrapper"},{default:c(()=>[o(R,{span:18,xs:22,sm:20,md:18,lg:16},{default:c(()=>[o(P,{class:"articles-card",shadow:"never"},{default:c(()=>[s("div",pe,[s("h3",he,[o(_,null,{default:c(()=>[o(A(Z))]),_:1}),t[3]||(t[3]=w(" 全部文章 ",-1)),s("span",me,"("+r(h.value.length)+")",1)]),o(T,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=l=>g.value=l),style:{width:"140px"},size:"small"},{default:c(()=>[o(y,{label:"最新发布",value:"date"}),o(y,{label:"最多阅读",value:"views"})]),_:1},8,["modelValue"])]),h.value.length===0&&!p.value?(i(),X(j,{key:0,description:"该作者暂无文章"})):(i(),u("div",ge,[(i(!0),u(S,null,ee($.value,l=>(i(),u("div",{key:l.id,class:"article-item",onClick:Fe=>M(l)},[l.cover?(i(),u("div",ye,[s("img",{src:l.cover,alt:l.title},null,8,we)])):C("",!0),s("div",Ae,[s("div",ke,[s("h4",be,r(l.title),1)]),s("p",xe,r(l.summary),1),s("div",De,[s("span",Ce,[o(_,null,{default:c(()=>[o(A(te))]),_:1}),w(" "+r(l.createdAt),1)]),s("span",Ie,[o(_,null,{default:c(()=>[o(A(se))]),_:1}),w(" "+r(F(l.views)),1)]),l.category?(i(),u("span",Ne,[o(_,null,{default:c(()=>[o(A(ae))]),_:1}),w(" "+r(l.category),1)])):C("",!0)])])],8,fe))),128))])),m.value>b.value?(i(),u("div",Ve,[o(L,{background:"",layout:"prev, pager, next",total:m.value,"current-page":k.value,"page-size":b.value,onCurrentChange:E},null,8,["total","current-page","page-size"])])):C("",!0)]),_:1})]),_:1})]),_:1})])),[[Y,p.value]])}}},Me=K(ze,[["__scopeId","data-v-9d829c07"]]);export{Me as default};
