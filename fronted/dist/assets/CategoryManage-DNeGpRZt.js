import{_ as ye,H as a,af as O,r as d,w as Ce,o as we,a as h,d as l,g as t,h as r,E as b,Y as R,X as N,W as $,V as A,U as I,T as j,S as G,R as q,Q as H,P as J,O as K,N as Q,M as W,L as X,K as Y,J as M,G as Z,D as ee,I as le,B as Ve,l as m,u as y,a2 as ke,m as g,ap as xe,a8 as he,A as ze,s as De,C as z,Z as ae,ar as Se,as as Ue,F as Me,p as Te,b as T,t as te,at as Le}from"./index-85xZPJNu.js";import{g as Be,d as Pe,c as Ee,u as Fe}from"./category-DxYcg0pP.js";const Oe={class:"page-container"},Re={key:1,style:{color:"#ccc"}},Ne={key:0,class:"pagination-container"},$e={style:{display:"flex","align-items":"center",gap:"8px"}},Ae={class:"dialog-footer"},Ie={__name:"CategoryManage",setup(je){const oe=[{value:"Folder",label:"文件夹",component:a(R)},{value:"Platform",label:"平台",component:a(N)},{value:"Monitor",label:"显示器",component:a($)},{value:"Cpu",label:"CPU",component:a(A)},{value:"Coin",label:"硬币",component:a(I)},{value:"Setting",label:"设置",component:a(j)},{value:"Document",label:"文档",component:a(G)},{value:"DataAnalysis",label:"数据分析",component:a(q)},{value:"Collection",label:"收藏",component:a(H)},{value:"Grid",label:"网格",component:a(J)},{value:"List",label:"列表",component:a(K)},{value:"Menu",label:"菜单",component:a(Q)},{value:"Operation",label:"操作",component:a(W)},{value:"Tools",label:"工具",component:a(X)},{value:"Connection",label:"连接",component:a(Y)},{value:"Link",label:"链接",component:a(M)},{value:"Share",label:"分享",component:a(Z)},{value:"Star",label:"星星",component:a(ee)},{value:"Trophy",label:"奖杯",component:a(le)}],L={Folder:a(R),Platform:a(N),Monitor:a($),Cpu:a(A),Coin:a(I),Setting:a(j),Document:a(G),DataAnalysis:a(q),Collection:a(H),Grid:a(J),List:a(K),Menu:a(Q),Operation:a(W),Tools:a(X),Connection:a(Y),Link:a(M),Share:a(Z),Star:a(ee),Trophy:a(le)},ne=s=>L[s]||L.Folder,u=O({name:"",slug:""}),_=d(1),C=d(10),D=d(0),S=d(!1),B=d([]),w=d(!1),k=d("create"),V=d(null),U=d(!1),n=O({id:null,name:"",slug:"",icon:"",description:""}),se={name:[{required:!0,message:"请输入分类名称",trigger:"blur"},{min:1,max:50,message:"分类名称长度在 1 到 50 个字符",trigger:"blur"}],slug:[{required:!0,message:"请输入别名",trigger:"blur"},{pattern:/^[a-z0-9-]+$/,message:"别名只能包含小写字母、数字和连字符",trigger:"blur"},{min:1,max:100,message:"别名长度在 1 到 100 个字符",trigger:"blur"}],description:[{max:500,message:"描述长度不能超过 500 个字符",trigger:"blur"}]},v=async()=>{S.value=!0;try{const s={page:_.value,size:C.value,name:u.name,slug:u.slug},e=await Be(s);B.value=e.list||[],D.value=e.total||0}catch(s){b.error("获取分类列表失败"),console.error(s)}finally{S.value=!1}},re=()=>{_.value=1,v()},ie=()=>{u.name="",u.slug="",_.value=1,v()},P=(s,e)=>{k.value=s,w.value=!0,V.value&&V.value.clearValidate(),s==="edit"&&e?Object.assign(n,{id:e.id,name:e.name||"",slug:e.slug||"",icon:e.icon||"",description:e.description||""}):Object.assign(n,{id:null,name:"",slug:"",icon:"",description:""})},ue=async()=>{var s,e;if(V.value){try{await V.value.validate()}catch{return}U.value=!0;try{const i={name:n.name,slug:n.slug,icon:n.icon||"",description:n.description||""};k.value==="create"?(await Ee(i),b.success("创建成功")):(await Fe({id:n.id,...i}),b.success("更新成功")),w.value=!1,setTimeout(()=>{v()},100)}catch(i){b.error(((e=(s=i.response)==null?void 0:s.data)==null?void 0:e.message)||"操作失败"),console.error("操作失败:",i)}finally{U.value=!1}}},de=s=>{Le.confirm("确认删除该分类？","提示",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(async()=>{try{await Pe({id:s.id}),b.success("删除成功"),v()}catch(e){b.error("删除失败"),console.error(e)}}).catch(()=>{})};return Ce([_,C],()=>{v()}),we(()=>{v()}),(s,e)=>{const i=r("el-input"),c=r("el-form-item"),f=r("el-button"),E=r("el-form"),F=r("el-card"),p=r("el-table-column"),x=r("el-icon"),ce=r("el-table"),pe=r("el-pagination"),me=r("EditPen"),fe=r("el-option"),ge=r("el-select"),_e=r("el-dialog"),ve=Ve("loading");return m(),h("div",Oe,[l(F,{shadow:"never",class:"filter-card"},{default:t(()=>[l(E,{inline:!0,model:u,class:"filter-form"},{default:t(()=>[l(c,{label:"分类名称"},{default:t(()=>[l(i,{modelValue:u.name,"onUpdate:modelValue":e[0]||(e[0]=o=>u.name=o),placeholder:"请输入分类名称",clearable:"",size:"default",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),l(c,{label:"别名"},{default:t(()=>[l(i,{modelValue:u.slug,"onUpdate:modelValue":e[1]||(e[1]=o=>u.slug=o),placeholder:"请输入别名",clearable:"",size:"default",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),l(c,null,{default:t(()=>[l(f,{type:"primary",icon:y(ke),onClick:re},{default:t(()=>[...e[11]||(e[11]=[g("查询",-1)])]),_:1},8,["icon"]),l(f,{icon:y(xe),onClick:ie},{default:t(()=>[...e[12]||(e[12]=[g("重置",-1)])]),_:1},8,["icon"])]),_:1}),l(c,{style:{"margin-left":"auto"}},{default:t(()=>[l(f,{type:"primary",icon:y(he),onClick:e[2]||(e[2]=o=>P("create"))},{default:t(()=>[...e[13]||(e[13]=[g("新增分类",-1)])]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),_:1}),l(F,{shadow:"never",class:"table-card"},{default:t(()=>[ze((m(),z(ce,{data:B.value,style:{width:"100%"}},{default:t(()=>[l(p,{prop:"id",label:"ID",width:"80"}),l(p,{label:"图标",width:"80",align:"center"},{default:t(o=>[o.row.icon?(m(),z(x,{key:0,size:20},{default:t(()=>[(m(),z(ae(ne(o.row.icon))))]),_:2},1024)):(m(),h("span",Re,"-"))]),_:1}),l(p,{prop:"name",label:"名称"}),l(p,{prop:"slug",label:"别名"}),l(p,{prop:"description",label:"描述","show-overflow-tooltip":""}),l(p,{prop:"count",label:"文章数",width:"100"}),l(p,{prop:"createdAt",label:"创建时间",width:"180"}),l(p,{label:"操作",width:"180",fixed:"right"},{default:t(o=>[l(f,{link:"",type:"primary",size:"small",icon:y(Se),onClick:be=>P("edit",o.row)},{default:t(()=>[...e[14]||(e[14]=[g("编辑",-1)])]),_:1},8,["icon","onClick"]),l(f,{link:"",type:"danger",size:"small",icon:y(Ue),onClick:be=>de(o.row)},{default:t(()=>[...e[15]||(e[15]=[g("删除",-1)])]),_:1},8,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[ve,S.value]]),D.value>C.value?(m(),h("div",Ne,[l(pe,{background:"",layout:"total, sizes, prev, pager, next, jumper",total:D.value,"page-sizes":[10,20,30,50],"current-page":_.value,"onUpdate:currentPage":e[3]||(e[3]=o=>_.value=o),"page-size":C.value,"onUpdate:pageSize":e[4]||(e[4]=o=>C.value=o)},null,8,["total","current-page","page-size"])])):De("",!0)]),_:1}),l(_e,{modelValue:w.value,"onUpdate:modelValue":e[10]||(e[10]=o=>w.value=o),title:k.value==="create"?"新增分类":"编辑分类",width:"600px","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:t(()=>[T("div",Ae,[l(f,{onClick:e[9]||(e[9]=o=>w.value=!1),size:"large"},{default:t(()=>[...e[16]||(e[16]=[g("取消",-1)])]),_:1}),l(f,{type:"primary",onClick:ue,size:"large",loading:U.value},{default:t(()=>[g(te(k.value==="create"?"创建":"保存"),1)]),_:1},8,["loading"])])]),default:t(()=>[l(E,{ref_key:"formRef",ref:V,model:n,rules:se,"label-width":"100px","label-position":"right"},{default:t(()=>[l(c,{label:"名称",prop:"name"},{default:t(()=>[l(i,{modelValue:n.name,"onUpdate:modelValue":e[5]||(e[5]=o=>n.name=o),placeholder:"请输入分类名称",clearable:"",size:"large"},{prefix:t(()=>[l(x,null,{default:t(()=>[l(me)]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(c,{label:"别名",prop:"slug"},{default:t(()=>[l(i,{modelValue:n.slug,"onUpdate:modelValue":e[6]||(e[6]=o=>n.slug=o),placeholder:"请输入别名（英文，用于URL）",clearable:"",size:"large"},{prefix:t(()=>[l(x,null,{default:t(()=>[l(y(M))]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(c,{label:"图标",prop:"icon"},{default:t(()=>[l(ge,{modelValue:n.icon,"onUpdate:modelValue":e[7]||(e[7]=o=>n.icon=o),placeholder:"请选择图标",clearable:"",filterable:"",style:{width:"100%"},size:"large"},{default:t(()=>[(m(),h(Me,null,Te(oe,o=>l(fe,{key:o.value,label:o.label,value:o.value},{default:t(()=>[T("div",$e,[l(x,null,{default:t(()=>[(m(),z(ae(o.component)))]),_:2},1024),T("span",null,te(o.label),1)])]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(c,{label:"描述",prop:"description"},{default:t(()=>[l(i,{modelValue:n.description,"onUpdate:modelValue":e[8]||(e[8]=o=>n.description=o),type:"textarea",rows:3,placeholder:"请输入分类描述",maxlength:"500","show-word-limit":"",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},He=ye(Ie,[["__scopeId","data-v-8072a412"]]);export{He as default};
