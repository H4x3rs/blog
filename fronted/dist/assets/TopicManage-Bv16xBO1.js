import{aB as ut,aC as pt,_ as vt,aD as H,aE as ft,r as v,ah as Te,c as ze,w as mt,o as _t,a as A,d as t,A as ge,g as a,h as Y,B as gt,C as q,s as te,F as Ae,p as Oe,E as h,l as _,u as c,a4 as he,m as f,ar as ht,aa as $e,b as s,as as Ee,y as Ie,at as yt,Q as Le,au as qe,t as u,v as ye,U as ue,ay as wt,L as bt,x as X,q as xt,ac as Ne,aF as Yt,aG as Vt,aH as Mt,av as Ze}from"./index-DJyl22Gq.js";import{d as kt}from"./marked.esm-DajSjiQI.js";import{g as Dt,a as pe,d as Ct,c as Tt,u as zt,e as we,r as At,f as Ot}from"./topic-BPYsRw4j.js";import{g as $t}from"./article-D0gsV2vB.js";import{g as It}from"./category-CYrCTtkN.js";var be={exports:{}},Lt=be.exports,We;function St(){return We||(We=1,(function(ve,le){(function(D,I){ve.exports=I()})(Lt,(function(){return function(D,I,P){D=D||{};var C=I.prototype,b={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function L(y,S,B,G){return C.fromToBase(y,S,B,G)}P.en.relativeTime=b,C.fromToBase=function(y,S,B,G,ee){for(var F,i,ae,R=B.$locale().relativeTime||b,se=D.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],fe=se.length,Q=0;Q<fe;Q+=1){var j=se[Q];j.d&&(F=G?P(y).diff(B,j.d,!0):B.diff(y,j.d,!0));var N=(D.rounding||Math.round)(Math.abs(F));if(ae=F>0,N<=j.r||!j.r){N<=1&&Q>0&&(j=se[Q-1]);var oe=R[j.l];ee&&(N=ee(""+N)),i=typeof oe=="string"?oe.replace("%d",N):oe(N,S,j.l,ae);break}}if(S)return i;var re=ae?R.future:R.past;return typeof re=="function"?re(i):re.replace("%s",i)},C.to=function(y,S){return L(y,S,this,!0)},C.from=function(y,S){return L(y,S,this)};var O=function(y){return y.$u?P.utc():P()};C.toNow=function(y){return this.to(O(this),y)},C.fromNow=function(y){return this.from(O(this),y)}}}))})(be)),be.exports}var Ft=St();const Ut=ut(Ft);var xe={exports:{}},Ht=xe.exports,Ge;function Pt(){return Ge||(Ge=1,(function(ve,le){(function(D,I){ve.exports=I(pt())})(Ht,(function(D){function I(b){return b&&typeof b=="object"&&"default"in b?b:{default:b}}var P=I(D),C={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(b,L){return L==="W"?b+"周":b+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(b,L){var O=100*b+L;return O<600?"凌晨":O<900?"早上":O<1100?"上午":O<1300?"中午":O<1800?"下午":"晚上"}};return P.default.locale(C,null,!0),C}))})(xe)),xe.exports}Pt();const Rt={class:"topic-manage"},jt={class:"topic-list"},Bt={key:1,class:"topic-grid"},Et={class:"topic-cover"},qt={class:"image-slot"},Nt={class:"topic-actions-overlay"},Zt={class:"topic-content"},Wt={class:"topic-header"},Gt=["title"],Qt={class:"topic-desc"},Kt={class:"topic-footer"},Jt={class:"date"},Xt={class:"date-text"},el={class:"article-count-badge"},tl={class:"count-text"},ll={key:2,class:"pagination-container"},al={class:"cover-image-container"},sl={class:"cover-input-group"},ol={class:"dialog-footer"},rl={class:"footer-left"},il={class:"footer-right"},nl={class:"cover-preview-dialog"},dl={class:"topic-preview-container"},cl={class:"header-content"},ul={class:"preview-meta-info"},pl={class:"preview-title"},vl={class:"preview-description"},fl={class:"preview-meta"},ml={class:"meta-item"},_l={class:"meta-item"},gl={class:"preview-content-wrapper"},hl={class:"section-title"},yl=["innerHTML"],wl={class:"articles-header"},bl={class:"section-title"},xl={class:"count"},Yl={key:0,class:"articles-list"},Vl={class:"article-number"},Ml={class:"article-content"},kl={class:"article-top"},Dl={class:"article-title"},Cl={class:"article-summary"},Tl={class:"article-meta"},zl={class:"meta-item"},Al={class:"meta-item"},Ol={key:0,class:"article-cover"},$l=["src","alt"],Il={class:"detail-dialog-header"},Ll={class:"header-left"},Sl={class:"header-info"},Fl={class:"topic-title"},Ul={class:"topic-description"},Hl={class:"header-right"},Pl={class:"detail-content"},Rl={class:"detail-stats"},jl={class:"stat-item"},Bl={class:"stat-info"},El={class:"stat-value"},ql={class:"stat-item"},Nl={class:"stat-info"},Zl={class:"stat-value"},Wl={class:"stat-item"},Gl={class:"stat-info"},Ql={class:"stat-value"},Kl={class:"articles-section"},Jl={class:"section-header"},Xl={class:"section-title"},ea={class:"sort-index"},ta={class:"article-title-cell"},la={class:"title-text"},aa={class:"views-cell"},sa={class:"date-cell"},oa={class:"date-text"},ra={style:{display:"flex","align-items":"center","justify-content":"center",gap:"8px","white-space":"nowrap"}},ia={key:0,class:"pagination-container",style:{"margin-top":"20px",display:"flex","justify-content":"flex-end"}},na={class:"dialog-search-area"},da={class:"article-title-cell"},ca={class:"title-text"},ua={class:"views-cell"},pa={class:"date-text"},va={class:"dialog-footer"},fa={class:"footer-info"},ma={key:0,class:"selection-info"},_a={class:"footer-actions"},ga={__name:"TopicManage",setup(ve){H.extend(Ut),H.extend(ft),H.locale("zh-cn");const le=v(!1),D=Te({name:""}),I=v([]),P=v(0),C=v(1),b=v(12),L=v(!1),O=v("create"),y=v(null),S=v(!1),B=v(!1),G=v(!1),ee=v(!1),F=v([]),i=Te({id:null,name:"",slug:"",description:"",coverImage:"",intro:"",isFeatured:0,sortOrder:0}),ae={name:[{required:!0,message:"请输入专题名称",trigger:"blur"},{min:2,max:100,message:"长度在 2 到 100 个字符",trigger:"blur"}],slug:[{required:!0,message:"请输入专题别名",trigger:"blur"},{pattern:/^[a-z0-9-]+$/,message:"别名只能包含小写字母、数字和连字符",trigger:"blur"},{min:1,max:100,message:"别名长度在 1 到 100 个字符",trigger:"blur"}],description:[{max:500,message:"描述不能超过 500 个字符",trigger:"blur"}],coverImage:[{type:"url",message:"请输入正确的URL地址",trigger:"blur"}],sortOrder:[{type:"number",min:0,max:9999,message:"排序值必须在 0 到 9999 之间",trigger:"blur"}]},R=async()=>{le.value=!0;try{const l=await Dt({page:C.value,size:b.value,name:D.name}),e=await Promise.all((l.list||[]).map(async r=>{var d;try{const n=await pe({id:r.id,page:1,size:100});if(n){const T=n.total??n.Total??((d=n.list)==null?void 0:d.length)??0;return{...r,articleCount:T}}else return console.warn(`获取专题 ${r.id} 的文章数量失败: 响应数据为空`,n),{...r,articleCount:0}}catch(n){return console.error(`获取专题 ${r.id} 的文章数量失败:`,n),{...r,articleCount:0}}}));I.value=e,P.value=l.total||0}catch(l){h.error("获取专题列表失败"),console.error(l)}finally{le.value=!1}},se=()=>{D.name="",R()},fe=(l,e)=>{O.value=l,L.value=!0,y.value&&y.value.clearValidate(),l==="edit"&&e?Object.assign(i,{id:e.id,name:e.name||"",slug:e.slug||"",description:e.description||"",coverImage:e.coverImage||"",intro:e.intro||"",isFeatured:e.isFeatured||0,sortOrder:e.sortOrder||0}):Object.assign(i,{id:null,name:"",slug:"",description:"",coverImage:"",intro:"",isFeatured:0,sortOrder:0})},Q=()=>{if(!i.coverImage){h.warning("请先输入封面图 URL");return}B.value=!0},j=async()=>{if(!i.name){h.warning("请先输入专题名称");return}if(ee.value=!0,G.value=!0,i.id)try{const l=await pe({id:i.id,page:1,size:100});F.value=l.list||[]}catch(l){console.error("加载专题文章失败:",l),F.value=[]}else F.value=[];ee.value=!1},N=ze(()=>F.value.length),oe=ze(()=>F.value.reduce((l,e)=>l+(e.views||0),0)),re=ze(()=>{if(!i.intro)return"";try{return kt.parse(i.intro)}catch{return i.intro}}),Qe=async()=>{var l,e;if(y.value){try{await y.value.validate()}catch{return}S.value=!0;try{const r={name:i.name,slug:i.slug||i.name.toLowerCase().replace(/\s+/g,"-"),description:i.description||"",coverImage:i.coverImage||"",intro:i.intro||i.description||"",isFeatured:i.isFeatured||0,sortOrder:i.sortOrder||0};O.value==="create"?(await Tt(r),h.success("专题创建成功")):(await zt({id:i.id,...r}),h.success("专题更新成功")),L.value=!1,R()}catch(r){h.error(((e=(l=r.response)==null?void 0:l.data)==null?void 0:e.message)||"操作失败"),console.error(r)}finally{S.value=!1}}},Ke=l=>{Ze.confirm("确定要删除这个专题吗？删除后无法恢复。","警告",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await Ct({id:l.id}),h.success("专题删除成功"),R()}catch(e){h.error("删除失败"),console.error(e)}}).catch(()=>{})},Je=l=>{x.value=l,Ye.value=!0,M.value=1,k.value=10,E({id:l.id},M.value,k.value)},Ye=v(!1),x=v(null),Ve=v(!1),U=v([]),M=v(1),k=v(10),me=v(0),ie=v(!1),Me=v(!1),Se=v([{id:101,title:"GoFrame 最佳实践指南",category:"Golang",views:1230,createdAt:"2024-05-03 10:30:00"},{id:102,title:"Vue 3 + Element Plus 全面解析",category:"Frontend",views:856,createdAt:"2024-05-02 14:20:00"},{id:103,title:"Docker 容器化部署实战",category:"DevOps",views:645,createdAt:"2024-05-01 09:15:00"},{id:104,title:"MySQL 索引优化指南",category:"Database",views:2341,createdAt:"2024-04-28 16:40:00"}]),Z=v([]),W=Te({title:"",categoryId:""}),ke=v([]),ne=v({}),De=async()=>{try{const l={},e=[];let r=1;const d=100;let n=!0;for(;n;){const g=(await It({page:r,size:d})).list||[];g.forEach(w=>{l[w.id]=w.name,e.push(w)}),g.length<d?n=!1:r++}ne.value=l,ke.value=e}catch(l){console.error("加载分类列表失败:",l)}},E=async(l,e=1,r=10)=>{Ve.value=!0;try{Object.keys(ne.value).length===0&&await De();const d=await pe({...l,page:e,size:r});U.value=(d.list||[]).map(n=>({...n,category:ne.value[n.categoryId]||"未分类"})),me.value=d.total||0}catch(d){h.error("获取专题文章失败"),console.error(d),U.value=[],me.value=0}finally{Ve.value=!1}},Xe=()=>U.value.reduce((l,e)=>l+(e.views||0),0),et=async()=>{ie.value=!0,ke.value.length===0&&await De(),Fe()},Fe=async()=>{Me.value=!0;try{Object.keys(ne.value).length===0&&await De();const l=await $t({page:1,size:50,title:W.title,categoryId:W.categoryId?parseInt(W.categoryId):0});Se.value=l.list||[]}catch(l){h.error("获取文章列表失败"),console.error(l)}finally{Me.value=!1}},tt=l=>{Z.value=l},lt=async()=>{var l,e,r,d;if(Z.value.length===0){h.warning("请选择要添加的文章");return}try{const n=await pe({id:x.value.id,page:1,size:100}),T=new Set((n.list||[]).map(V=>V.articleId)),g=Z.value.filter(V=>T.has(V.id));if(g.length>0){const V=g.map(z=>z.title).join("、");h.warning(`以下文章已在专题中，无法重复添加：${V}`);return}const w=n.list||[];let de=(w.length>0?Math.max(...w.map(V=>V.sortOrder||0)):-1)+1;const K=[],ce=[];for(const V of Z.value)try{await Ot({id:x.value.id,articleId:V.id,sortOrder:de}),K.push(V.title),de++}catch(z){const J=z.message||((e=(l=z.response)==null?void 0:l.data)==null?void 0:e.message)||"添加失败";ce.push({title:V.title,error:J}),console.error(`添加文章 ${V.title} 失败:`,z)}if(K.length>0&&h.success(`成功添加 ${K.length} 篇文章到专题`),ce.length>0){const V=ce.map(z=>`${z.title}(${z.error})`).join("、");h.warning(`以下文章添加失败：${V}`)}K.length>0&&(ie.value=!1,Z.value=[],E({id:x.value.id},M.value,k.value),Ue(x.value.id))}catch(n){const T=n.message||((d=(r=n.response)==null?void 0:r.data)==null?void 0:d.message)||"添加文章失败";h.error(T),console.error(n)}},at=l=>{Ze.confirm("确定要将此文章从专题中移除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await At({id:x.value.id,articleId:l.articleId}),h.success("文章已从专题中移除"),E({id:x.value.id},M.value,k.value),Ue(x.value.id)}catch(e){h.error("移除文章失败"),console.error(e)}}).catch(()=>{})},st=async l=>{if(l!==0)try{const e=U.value[l],r=U.value[l-1],d=e.sortOrder;e.sortOrder=r.sortOrder,r.sortOrder=d,await Promise.all([we({id:e.id,sortOrder:e.sortOrder}),we({id:r.id,sortOrder:r.sortOrder})]),await E({id:x.value.id},M.value,k.value),h.success("排序已更新")}catch(e){h.error("更新排序失败"),console.error(e),await E({id:x.value.id},M.value,k.value)}},ot=async l=>{if(l!==U.value.length-1)try{const e=U.value[l],r=U.value[l+1],d=e.sortOrder;e.sortOrder=r.sortOrder,r.sortOrder=d,await Promise.all([we({id:e.id,sortOrder:e.sortOrder}),we({id:r.id,sortOrder:r.sortOrder})]),await E({id:x.value.id},M.value,k.value),h.success("排序已更新")}catch(e){h.error("更新排序失败"),console.error(e),await E({id:x.value.id},M.value,k.value)}},rt=l=>{M.value=l,E({id:x.value.id},M.value,k.value)},it=l=>{k.value=l,M.value=1,E({id:x.value.id},M.value,k.value)},Ue=async l=>{var e;try{const r=await pe({id:l,page:1,size:100});if(console.log(`专题 ${l} 的文章响应:`,r),r){const d=r.total??r.Total??((e=r.list)==null?void 0:e.length)??0,n=I.value.find(T=>T.id===l);n&&(n.articleCount=d,console.log(`专题 ${l} 的文章数量已更新为:`,d))}else console.warn(`获取专题 ${l} 的文章数量失败: 响应数据为空`,r)}catch(r){console.error(`更新专题 ${l} 的文章数量失败:`,r)}},He=l=>{if(!l)return"";try{let e=null;const r=String(l).trim(),d=["YYYY-MM-DD HH:mm:ss","YYYY-MM-DDTHH:mm:ssZ","YYYY-MM-DDTHH:mm:ss.SSSZ","YYYY-MM-DD HH:mm:ss.SSS","YYYY-MM-DD","YYYY/MM/DD HH:mm:ss","YYYY/MM/DD"];if(e=H(r),!e.isValid()){for(const w of d)if(e=H(r,w,!0),e.isValid())break}if(!e.isValid()){const w=r.replace(/T/," ").replace(/Z/,"").replace(/\+.*$/,"").trim();e=H(w)}if(!e.isValid()){const w=r.match(/(\d{4}-\d{2}-\d{2})/);w&&(e=H(w[1],"YYYY-MM-DD",!0))}if(!e.isValid()){console.warn("无法解析日期:",l);const w=r.match(/(\d{4}-\d{2}-\d{2})/);return w?w[0]:l}const n=H().startOf("day"),T=e.startOf("day"),g=n.diff(T,"day");return g>0&&g<7?`${g}天前`:g>0&&g<30?`${Math.floor(g/7)}周前`:g>0&&g<365?`${Math.floor(g/30)}个月前`:(g<0,e.format("YYYY-MM-DD"))}catch(e){if(console.error("日期格式化错误:",e,l),typeof l=="string"){const r=l.match(/(\d{4}-\d{2}-\d{2})/);if(r)return r[0]}return String(l)}},Ce=l=>!l&&l!==0?"0":l>=1e4?(l/1e4).toFixed(1)+"W":l>=1e3?(l/1e3).toFixed(1)+"K":l.toString(),Pe=l=>{if(!l)return"";try{let e=H(l);if(!e.isValid()){const r=String(l).replace(/T/," ").replace(/Z/,"").replace(/\+.*$/,"");if(e=H(r),!e.isValid()){const d=String(l).match(/(\d{4}-\d{2}-\d{2})/);d&&(e=H(d[1]))}if(!e.isValid()){const d=String(l).match(/(\d{4}-\d{2}-\d{2})/);return d?d[0]:l}}return e.format("YYYY-MM-DD")}catch(e){if(console.error("日期格式化错误:",e,l),typeof l=="string"){const r=l.match(/(\d{4}-\d{2}-\d{2})/);if(r)return r[0]}return String(l)}};return mt([C,b],()=>{R()}),_t(()=>{R()}),(l,e)=>{var je;const r=Y("el-input"),d=Y("el-form-item"),n=Y("el-button"),T=Y("el-form"),g=Y("el-card"),w=Y("el-empty"),m=Y("el-icon"),de=Y("el-image"),K=Y("el-pagination"),ce=Y("el-switch"),V=Y("el-input-number"),z=Y("el-dialog"),J=Y("el-tag"),nt=Y("el-divider"),$=Y("el-table-column"),Re=Y("el-table"),dt=Y("el-option"),ct=Y("el-select"),_e=gt("loading");return _(),A("div",Rt,[t(g,{shadow:"never",class:"filter-card"},{default:a(()=>[t(T,{inline:!0,model:D,class:"filter-form"},{default:a(()=>[t(d,{label:"专题名称"},{default:a(()=>[t(r,{modelValue:D.name,"onUpdate:modelValue":e[0]||(e[0]=o=>D.name=o),placeholder:"请输入专题名称",clearable:"","prefix-icon":c(he),style:{width:"260px"},size:"default"},null,8,["modelValue","prefix-icon"])]),_:1}),t(d,null,{default:a(()=>[t(n,{type:"primary",icon:c(he),onClick:R,size:"default"},{default:a(()=>[...e[22]||(e[22]=[f("查询",-1)])]),_:1},8,["icon"]),t(n,{icon:c(ht),onClick:se,size:"default"},{default:a(()=>[...e[23]||(e[23]=[f("重置",-1)])]),_:1},8,["icon"])]),_:1}),t(d,{style:{"margin-left":"auto"}},{default:a(()=>[t(n,{type:"primary",icon:c($e),onClick:e[1]||(e[1]=o=>fe("create")),size:"default"},{default:a(()=>[...e[24]||(e[24]=[s("span",{style:{"margin-left":"4px"}},"创建专题",-1)])]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),_:1}),ge((_(),A("div",jt,[I.value.length===0?(_(),q(w,{key:0,description:"暂无专题数据"})):(_(),A("div",Bt,[(_(!0),A(Ae,null,Oe(I.value,o=>(_(),A("div",{key:o.id,class:"topic-card-wrapper"},[t(g,{shadow:"hover",class:"topic-card","body-style":{padding:"0px"}},{default:a(()=>[s("div",Et,[t(de,{src:o.coverImage,fit:"cover",lazy:""},{error:a(()=>[s("div",qt,[t(m,null,{default:a(()=>[t(c(Ee))]),_:1})])]),_:1},8,["src"]),s("div",Nt,[t(n,{circle:"",type:"primary",icon:c(yt),onClick:Ie(p=>fe("edit",o),["stop"])},null,8,["icon","onClick"]),t(n,{circle:"",type:"success",icon:c(Le),onClick:Ie(p=>Je(o),["stop"])},null,8,["icon","onClick"]),t(n,{circle:"",type:"danger",icon:c(qe),onClick:Ie(p=>Ke(o),["stop"])},null,8,["icon","onClick"])])]),s("div",Zt,[s("div",Wt,[s("h3",{class:"topic-name",title:o.name},u(o.name),9,Gt)]),s("p",Qt,u(o.description||"暂无描述"),1),s("div",Kt,[s("span",Jt,[t(m,{class:"date-icon"},{default:a(()=>[t(c(ye))]),_:1}),s("span",Xt,u(He(o.createdAt)),1)]),s("div",el,[t(m,{class:"count-icon"},{default:a(()=>[t(c(ue))]),_:1}),s("span",tl,u(o.articleCount||0)+"篇文章",1)])])])]),_:2},1024)]))),128))])),P.value>b.value?(_(),A("div",ll,[t(K,{background:"",layout:"total, prev, pager, next, jumper",total:P.value,"current-page":C.value,"onUpdate:currentPage":e[2]||(e[2]=o=>C.value=o),"page-size":b.value,"onUpdate:pageSize":e[3]||(e[3]=o=>b.value=o)},null,8,["total","current-page","page-size"])])):te("",!0)])),[[_e,le.value]]),t(z,{modelValue:L.value,"onUpdate:modelValue":e[12]||(e[12]=o=>L.value=o),title:O.value==="create"?"创建专题":"编辑专题",width:"800px","align-center":"","close-on-click-modal":!1,"close-on-press-escape":!1,"destroy-on-close":""},{footer:a(()=>[s("div",ol,[s("div",rl,[t(n,{type:"info",icon:c(X),onClick:j,size:"large",disabled:!i.name},{default:a(()=>[...e[27]||(e[27]=[f(" 预览专题 ",-1)])]),_:1},8,["icon","disabled"])]),s("div",il,[t(n,{onClick:e[11]||(e[11]=o=>L.value=!1),size:"large"},{default:a(()=>[...e[28]||(e[28]=[f("取消",-1)])]),_:1}),t(n,{type:"primary",onClick:Qe,size:"large",loading:S.value},{default:a(()=>[f(u(O.value==="create"?"创建":"保存"),1)]),_:1},8,["loading"])])])]),default:a(()=>[t(T,{model:i,rules:ae,ref_key:"topicFormRef",ref:y,"label-width":"100px","label-position":"right"},{default:a(()=>[t(d,{label:"专题名称",prop:"name"},{default:a(()=>[t(r,{modelValue:i.name,"onUpdate:modelValue":e[4]||(e[4]=o=>i.name=o),placeholder:"请输入专题名称",clearable:"",size:"large"},{prefix:a(()=>[t(m,null,{default:a(()=>[t(c(wt))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"专题别名",prop:"slug"},{default:a(()=>[t(r,{modelValue:i.slug,"onUpdate:modelValue":e[5]||(e[5]=o=>i.slug=o),placeholder:"专题别名（URL友好格式，英文）",clearable:"",size:"large"},{prefix:a(()=>[t(m,null,{default:a(()=>[t(c(bt))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"专题描述",prop:"description"},{default:a(()=>[t(r,{modelValue:i.description,"onUpdate:modelValue":e[6]||(e[6]=o=>i.description=o),type:"textarea",rows:3,placeholder:"请输入专题描述",maxlength:"500","show-word-limit":"",clearable:""},null,8,["modelValue"])]),_:1}),t(d,{label:"专题介绍",prop:"intro"},{default:a(()=>[t(r,{modelValue:i.intro,"onUpdate:modelValue":e[7]||(e[7]=o=>i.intro=o),type:"textarea",rows:4,placeholder:"请输入专题详细介绍",clearable:""},null,8,["modelValue"])]),_:1}),t(d,{label:"封面图片",prop:"coverImage"},{default:a(()=>[s("div",al,[s("div",sl,[t(r,{modelValue:i.coverImage,"onUpdate:modelValue":e[8]||(e[8]=o=>i.coverImage=o),placeholder:"请输入图片URL，支持 http/https 链接",clearable:"",size:"large",class:"cover-input"},{prefix:a(()=>[t(m,null,{default:a(()=>[t(c(Ee))]),_:1})]),_:1},8,["modelValue"]),t(n,{icon:c(X),onClick:Q,disabled:!i.coverImage,size:"large",type:"primary",class:"preview-btn"},{default:a(()=>[...e[25]||(e[25]=[f(" 预览 ",-1)])]),_:1},8,["icon","disabled"])])])]),_:1}),t(d,{label:"是否置顶",prop:"isFeatured"},{default:a(()=>[t(ce,{modelValue:i.isFeatured,"onUpdate:modelValue":e[9]||(e[9]=o=>i.isFeatured=o),"active-value":1,"inactive-value":0,"active-text":"是","inactive-text":"否","inline-prompt":"",class:"featured-switch",style:{"--el-switch-on-color":"#67c23a"}},null,8,["modelValue"])]),_:1}),t(d,{label:"排序",prop:"sortOrder"},{default:a(()=>[t(V,{modelValue:i.sortOrder,"onUpdate:modelValue":e[10]||(e[10]=o=>i.sortOrder=o),min:0,max:9999,size:"large",style:{width:"200px"}},null,8,["modelValue"]),e[26]||(e[26]=s("span",{class:"form-tip"},"数字越小越靠前",-1))]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(z,{modelValue:B.value,"onUpdate:modelValue":e[13]||(e[13]=o=>B.value=o),title:"封面图预览",width:"600px"},{default:a(()=>[s("div",nl,[i.coverImage?(_(),q(de,{key:0,src:i.coverImage,alt:"封面图预览",fit:"contain",style:{"max-width":"100%","max-height":"500px"}},null,8,["src"])):(_(),q(w,{key:1,description:"暂无封面图"}))])]),_:1},8,["modelValue"]),t(z,{modelValue:G.value,"onUpdate:modelValue":e[14]||(e[14]=o=>G.value=o),title:"专题预览",width:"90%",top:"5vh","destroy-on-close":"",class:"topic-preview-dialog","close-on-click-modal":!1},{default:a(()=>[ge((_(),A("div",dl,[s("div",{class:"preview-header",style:xt({backgroundImage:`url(${i.coverImage||"https://picsum.photos/1200/400"})`})},[e[31]||(e[31]=s("div",{class:"header-overlay"},null,-1)),s("div",cl,[s("div",ul,[i.isFeatured===1?(_(),q(J,{key:0,effect:"dark",round:"",class:"featured-tag"},{default:a(()=>[...e[29]||(e[29]=[f(" 置顶专题 ",-1)])]),_:1})):te("",!0)]),s("h1",pl,u(i.name||"专题名称"),1),s("p",vl,u(i.description||"专题描述"),1),s("div",fl,[s("span",ml,[t(m,null,{default:a(()=>[t(c(ue))]),_:1}),f(" "+u(N.value)+" 篇文章 ",1)]),e[30]||(e[30]=s("span",{class:"divider"},"·",-1)),s("span",_l,[t(m,null,{default:a(()=>[t(c(X))]),_:1}),f(" "+u(Ce(oe.value))+" 阅读 ",1)])])])],4),s("div",gl,[i.intro?(_(),q(g,{key:0,class:"preview-intro-card",shadow:"never"},{default:a(()=>[s("h3",hl,[t(m,null,{default:a(()=>[t(c(Ne))]),_:1}),e[32]||(e[32]=f(" 专题介绍 ",-1))]),s("div",{class:"markdown-body",innerHTML:re.value},null,8,yl)]),_:1})):te("",!0),t(g,{class:"preview-articles-card",shadow:"never"},{default:a(()=>[s("div",wl,[s("h3",bl,[t(m,null,{default:a(()=>[t(c(Le))]),_:1}),e[33]||(e[33]=f(" 文章列表 ",-1)),s("span",xl,"("+u(F.value.length)+")",1)])]),F.value.length>0?(_(),A("div",Yl,[(_(!0),A(Ae,null,Oe(F.value,(o,p)=>(_(),A("div",{key:o.id,class:"article-item"},[s("div",Vl,u(p+1),1),s("div",Ml,[s("div",kl,[s("h4",Dl,u(o.title),1)]),s("p",Cl,u(o.desc||"暂无摘要"),1),s("div",Tl,[s("span",zl,[t(m,null,{default:a(()=>[t(c(ye))]),_:1}),f(" "+u(Pe(o.createdAt)),1)]),s("span",Al,[t(m,null,{default:a(()=>[t(c(X))]),_:1}),f(" "+u(Ce(o.views||0)),1)])])]),o.coverImage?(_(),A("div",Ol,[s("img",{src:o.coverImage,alt:o.title},null,8,$l)])):te("",!0)]))),128))])):(_(),q(w,{key:1,description:"暂无文章，预览时将显示空状态"}))]),_:1})])])),[[_e,ee.value]])]),_:1},8,["modelValue"]),t(z,{modelValue:Ye.value,"onUpdate:modelValue":e[17]||(e[17]=o=>Ye.value=o),title:(je=x.value)==null?void 0:je.name,width:"85%","destroy-on-close":"",class:"topic-detail-dialog",top:"5vh"},{header:a(()=>{var o,p;return[s("div",Il,[s("div",Ll,[t(m,{size:24,color:"#409eff"},{default:a(()=>[t(c(Ne))]),_:1}),s("div",Sl,[s("h3",Fl,u((o=x.value)==null?void 0:o.name),1),s("p",Ul,u(((p=x.value)==null?void 0:p.description)||"暂无描述"),1)])]),s("div",Hl,[t(n,{type:"primary",icon:c($e),onClick:et},{default:a(()=>[...e[34]||(e[34]=[f("添加文章",-1)])]),_:1},8,["icon"])])])]}),default:a(()=>{var o;return[s("div",Pl,[s("div",Rl,[s("div",jl,[t(m,null,{default:a(()=>[t(c(ue))]),_:1}),s("div",Bl,[s("span",El,u(U.value.length),1),e[35]||(e[35]=s("span",{class:"stat-label"},"文章数量",-1))])]),s("div",ql,[t(m,null,{default:a(()=>[t(c(X))]),_:1}),s("div",Nl,[s("span",Zl,u(Xe()),1),e[36]||(e[36]=s("span",{class:"stat-label"},"总阅读量",-1))])]),s("div",Wl,[t(m,null,{default:a(()=>[t(c(ye))]),_:1}),s("div",Gl,[s("span",Ql,u(He((o=x.value)==null?void 0:o.createdAt)),1),e[37]||(e[37]=s("span",{class:"stat-label"},"创建时间",-1))])])]),t(nt),s("div",Kl,[s("div",Jl,[s("h4",Xl,[t(m,null,{default:a(()=>[t(c(Le))]),_:1}),e[38]||(e[38]=s("span",null,"专题文章列表",-1))])]),ge((_(),q(Re,{data:U.value,style:{width:"100%"},"row-key":"id","header-cell-style":{background:"#fafafa",color:"#303133",fontWeight:"600",fontSize:"13px"},"cell-style":{fontSize:"13px"},stripe:"","empty-text":"暂无文章，点击上方按钮添加",class:"topic-articles-table"},{default:a(()=>[t($,{label:"排序",width:"80",align:"center"},{default:a(p=>[s("span",ea,u(p.$index+1+(M.value-1)*k.value),1)]),_:1}),t($,{prop:"articleId",label:"文章ID",width:"85",align:"center"},{default:a(p=>[t(J,{size:"small",effect:"plain",type:"info",style:{"font-weight":"600"}},{default:a(()=>[f(u(p.row.articleId||"-"),1)]),_:2},1024)]),_:1}),t($,{prop:"title",label:"文章标题","min-width":"250","show-overflow-tooltip":""},{default:a(p=>[s("div",ta,[t(m,{color:"#409eff"},{default:a(()=>[t(c(ue))]),_:1}),s("span",la,u(p.row.title),1)])]),_:1}),t($,{prop:"category",label:"分类",width:"120",align:"center"},{default:a(p=>[t(J,{size:"small",type:"success",effect:"plain"},{default:a(()=>[f(u(p.row.category),1)]),_:2},1024)]),_:1}),t($,{prop:"views",label:"阅读量",width:"100",align:"center"},{default:a(p=>[s("div",aa,[t(m,null,{default:a(()=>[t(c(X))]),_:1}),s("span",null,u(Ce(p.row.views||0)),1)])]),_:1}),t($,{prop:"createdAt",label:"发布时间",width:"160",align:"center"},{default:a(p=>[s("div",sa,[t(m,{class:"date-icon-small"},{default:a(()=>[t(c(ye))]),_:1}),s("span",oa,u(Pe(p.row.createdAt)),1)])]),_:1}),t($,{label:"操作",width:"200",fixed:"right"},{default:a(p=>[s("div",ra,[t(n,{link:"",size:"small",icon:c(Yt),disabled:p.$index===0,onClick:Be=>st(p.$index)},{default:a(()=>[...e[39]||(e[39]=[f(" 上移 ",-1)])]),_:1},8,["icon","disabled","onClick"]),t(n,{link:"",size:"small",icon:c(Vt),disabled:p.$index===U.value.length-1,onClick:Be=>ot(p.$index)},{default:a(()=>[...e[40]||(e[40]=[f(" 下移 ",-1)])]),_:1},8,["icon","disabled","onClick"]),t(n,{link:"",type:"danger",size:"small",icon:c(qe),onClick:Be=>at(p.row)},{default:a(()=>[...e[41]||(e[41]=[f(" 移除 ",-1)])]),_:1},8,["icon","onClick"])])]),_:1})]),_:1},8,["data"])),[[_e,Ve.value]]),me.value>k.value?(_(),A("div",ia,[t(K,{"current-page":M.value,"onUpdate:currentPage":e[15]||(e[15]=p=>M.value=p),"page-size":k.value,"onUpdate:pageSize":e[16]||(e[16]=p=>k.value=p),"page-sizes":[10,20,50,100],total:me.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:rt,onSizeChange:it},null,8,["current-page","page-size","total"])])):te("",!0)])])]}),_:1},8,["modelValue","title"]),t(z,{modelValue:ie.value,"onUpdate:modelValue":e[21]||(e[21]=o=>ie.value=o),title:"添加文章到专题",width:"70%","destroy-on-close":"",class:"article-dialog"},{footer:a(()=>[s("div",va,[s("div",fa,[Z.value.length>0?(_(),A("span",ma,[t(m,null,{default:a(()=>[t(c(Mt))]),_:1}),f(" 已选择 "+u(Z.value.length)+" 篇文章 ",1)])):te("",!0)]),s("div",_a,[t(n,{size:"large",onClick:e[20]||(e[20]=o=>ie.value=!1)},{default:a(()=>[...e[43]||(e[43]=[f("取消",-1)])]),_:1}),t(n,{type:"primary",size:"large",onClick:lt,disabled:Z.value.length===0,icon:c($e)},{default:a(()=>[...e[44]||(e[44]=[f(" 添加选中文章 ",-1)])]),_:1},8,["disabled","icon"])])])]),default:a(()=>[s("div",na,[t(T,{inline:!0,model:W,class:"filter-form"},{default:a(()=>[t(d,{label:"文章标题"},{default:a(()=>[t(r,{modelValue:W.title,"onUpdate:modelValue":e[18]||(e[18]=o=>W.title=o),placeholder:"搜索文章标题",clearable:"","prefix-icon":c(he),style:{width:"280px"}},null,8,["modelValue","prefix-icon"])]),_:1}),t(d,{label:"分类"},{default:a(()=>[t(ct,{modelValue:W.categoryId,"onUpdate:modelValue":e[19]||(e[19]=o=>W.categoryId=o),placeholder:"请选择分类",clearable:"",style:{width:"200px"}},{default:a(()=>[(_(!0),A(Ae,null,Oe(ke.value,o=>(_(),q(dt,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(d,null,{default:a(()=>[t(n,{type:"primary",icon:c(he),onClick:Fe},{default:a(()=>[...e[42]||(e[42]=[f("搜索",-1)])]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),ge((_(),q(Re,{data:Se.value,style:{width:"100%"},onSelectionChange:tt,"header-cell-style":{background:"#fafafa",color:"#303133",fontWeight:"600"},stripe:"","max-height":"450"},{default:a(()=>[t($,{type:"selection",width:"55",align:"center"}),t($,{prop:"id",label:"ID",width:"70",align:"center"},{default:a(o=>[t(J,{size:"small",effect:"plain"},{default:a(()=>[f("#"+u(o.row.id),1)]),_:2},1024)]),_:1}),t($,{prop:"title",label:"标题","min-width":"250","show-overflow-tooltip":""},{default:a(o=>[s("div",da,[t(m,{color:"#409eff"},{default:a(()=>[t(c(ue))]),_:1}),s("span",ca,u(o.row.title),1)])]),_:1}),t($,{prop:"categoryId",label:"分类",width:"120",align:"center"},{default:a(o=>[t(J,{size:"small",type:"success",effect:"plain"},{default:a(()=>[f(u(ne.value[o.row.categoryId]||"未分类"),1)]),_:2},1024)]),_:1}),t($,{prop:"views",label:"阅读量",width:"110",align:"center"},{default:a(o=>[s("div",ua,[t(m,null,{default:a(()=>[t(c(X))]),_:1}),s("span",null,u(o.row.views),1)])]),_:1}),t($,{prop:"createdAt",label:"发布时间",width:"180",align:"center"},{default:a(o=>[s("span",pa,u(o.row.createdAt),1)]),_:1})]),_:1},8,["data"])),[[_e,Me.value]])]),_:1},8,["modelValue"])])}}},Ya=vt(ga,[["__scopeId","data-v-2aabd20f"]]);export{Ya as default};
