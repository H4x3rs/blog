import{_ as E,j as R,r as A,o as V,z as F,k as j,c as H,A as q,B as G,a as B,b as s,d as a,C as f,s as T,g as n,h as l,t as i,q as Y,E as J,l as d,m as u,F as K,p as O,u as C,D as P,G as Q}from"./index-DuLhCfRm.js";import{d as W}from"./marked.esm-DajSjiQI.js";import{a as X}from"./article-DBv_1yDe.js";const Z={class:"article-detail-container"},S={class:"article-header"},tt={class:"header-content"},et={class:"meta-info"},st={class:"date"},ot={class:"title"},at={class:"author-info"},nt={class:"views"},it={class:"topic-content"},lt={class:"topic-name"},rt={class:"topic-desc"},ct={class:"topic-stats"},dt={class:"topic-action"},ut=["innerHTML"],pt={class:"article-footer"},vt={class:"tags-list"},_t={class:"actions"},mt={class:"comments-section"},ft={__name:"ArticleDetail",setup(gt){const D=R(),g=j(),y=D.params.id,o=A({id:y,title:"",category:"",createdAt:"",views:0,cover:"",tags:[],content:""}),p=A(!0),$=t=>{if(!t)return"";try{const e=new Date(t);if(isNaN(e.getTime()))return t;const r=e.getFullYear(),v=String(e.getMonth()+1).padStart(2,"0"),_=String(e.getDate()).padStart(2,"0");return`${r}-${v}-${_}`}catch{return typeof t=="string"&&/^\d{4}-\d{2}-\d{2}/.test(t)?t.split(" ")[0]||t.split("T")[0]:t}},U=async()=>{p.value=!0;try{const t=await X({id:parseInt(y)});t&&(o.value={id:t.id,title:t.title||"",category:t.categoryName||"",createdAt:$(t.createdAt),views:t.views||0,cover:t.coverImage||"https://picsum.photos/id/"+t.id+"/1200/600",tags:t.tags?typeof t.tags=="string"?t.tags.split(","):t.tags:[],content:t.content||"",publishedByUser:t.publishedByUser||null})}catch(t){console.error("åŠ è½½æ–‡ç« å¤±è´¥:",t),J.error("åŠ è½½æ–‡ç« å¤±è´¥")}finally{p.value=!1}};V(()=>{U(),F(()=>{document.addEventListener("click",N)})});const N=t=>{const e=t.target.closest("a.topic-link");if(e){t.preventDefault();const r=e.getAttribute("data-topic-id");r&&g.push(`/topic/${r}`)}},h=t=>{t&&t.id&&g.push(`/author/${t.id}`)},I=H(()=>{if(!o.value.content)return"";let t=W.parse(o.value.content);return t=t.replace(/<a href="\/topic\/(\d+)"/g,'<a href="/topic/$1" class="topic-link" data-topic-id="$1"'),t});return(t,e)=>{var b;const r=l("el-tag"),v=l("el-avatar"),_=l("ArrowRight"),m=l("el-icon"),k=l("el-card"),w=l("el-button"),z=l("el-empty"),L=l("el-col"),M=l("el-row"),x=G("loading");return q((d(),B("div",Z,[s("div",S,[s("div",tt,[s("div",et,[a(r,{effect:"dark",round:"",class:"category-tag"},{default:n(()=>[u(i(o.value.category),1)]),_:1}),o.value.topic?(d(),f(r,{key:0,effect:"dark",round:"",class:"topic-tag",onClick:t.goToTopic},{default:n(()=>[u(" ğŸ“š "+i(o.value.topic.name),1)]),_:1},8,["onClick"])):T("",!0),s("span",st,i(o.value.createdAt),1)]),s("h1",ot,i(o.value.title),1),s("div",at,[a(v,{size:32,src:((b=o.value.publishedByUser)==null?void 0:b.avatar)||"https://picsum.photos/id/64/100/100",onClick:e[0]||(e[0]=c=>h(o.value.publishedByUser)),style:{cursor:"pointer"}},null,8,["src"]),s("span",{class:"author-name",onClick:e[1]||(e[1]=c=>h(o.value.publishedByUser)),style:{cursor:"pointer"}},i(o.value.publishedByUser?o.value.publishedByUser.nickname||o.value.publishedByUser.username:"Admin"),1),e[3]||(e[3]=s("span",{class:"divider"},"Â·",-1)),e[4]||(e[4]=s("span",{class:"read-time"},"5 min read",-1)),e[5]||(e[5]=s("span",{class:"divider"},"Â·",-1)),s("span",nt,i(o.value.views)+" views",1)])]),s("div",{class:"header-image",style:Y({backgroundImage:`url(${o.value.cover})`})},null,4)]),a(M,{justify:"center",class:"content-wrapper"},{default:n(()=>[a(L,{span:16,xs:22},{default:n(()=>[o.value.topic?(d(),f(k,{key:0,class:"topic-info-card",shadow:"never"},{default:n(()=>[s("div",{class:"topic-info",onClick:e[2]||(e[2]=(...c)=>t.goToTopic&&t.goToTopic(...c))},[e[8]||(e[8]=s("div",{class:"topic-icon"},"ğŸ“š",-1)),s("div",it,[e[7]||(e[7]=s("div",{class:"topic-label"},"æœ¬æ–‡å±äºä¸“é¢˜",-1)),s("div",lt,i(o.value.topic.name),1),s("div",rt,i(o.value.topic.description),1),s("div",ct,[s("span",null,i(o.value.topic.articleCount)+" ç¯‡æ–‡ç« ",1),e[6]||(e[6]=s("span",{class:"divider"},"Â·",-1)),s("span",null,i(o.value.topic.progress),1)])]),s("div",dt,[a(m,null,{default:n(()=>[a(_)]),_:1})])])]),_:1})):T("",!0),a(k,{class:"content-card",shadow:"never"},{default:n(()=>[s("div",{class:"markdown-body",innerHTML:I.value},null,8,ut),s("div",pt,[s("div",vt,[(d(!0),B(K,null,O(o.value.tags,c=>(d(),f(r,{key:c,class:"tag-item",effect:"plain"},{default:n(()=>[u("# "+i(c),1)]),_:2},1024))),128))]),s("div",_t,[a(w,{type:"primary",plain:"",round:"",size:"small"},{default:n(()=>[a(m,null,{default:n(()=>[a(C(P))]),_:1}),e[9]||(e[9]=u(" ç‚¹èµ ",-1))]),_:1}),a(w,{round:"",size:"small"},{default:n(()=>[a(m,null,{default:n(()=>[a(C(Q))]),_:1}),e[10]||(e[10]=u(" åˆ†äº« ",-1))]),_:1})])])]),_:1}),s("div",mt,[e[11]||(e[11]=s("h3",null,"è¯„è®º (0)",-1)),a(z,{description:"æš‚æ— è¯„è®ºï¼Œå¿«æ¥æŠ¢æ²™å‘å§ï¼"})])]),_:1})]),_:1})])),[[x,p.value]])}}},wt=E(ft,[["__scopeId","data-v-d4b90a24"]]);export{wt as default};
