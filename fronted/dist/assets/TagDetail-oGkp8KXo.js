import{_ as W,c as b,j as q,r as f,o as G,w as J,A as P,B as Q,a as _,b as s,d as a,g as o,h as u,t as i,m as d,E as $,k as X,l as r,u as c,a4 as Y,S as Z,x as F,a7 as ee,a8 as se,C as x,s as h,O as te,F as S,p as E,v as ae,$ as le,a0 as oe}from"./index-DEcr5ABh.js";import{a as ne,g as ie}from"./tag-CXny1ULX.js";const de={class:"tag-detail-container"},ce={class:"tag-header"},re={class:"header-content"},ue={class:"tag-icon-large"},_e={class:"title"},ve={class:"description"},pe={class:"tag-meta"},me={class:"meta-item"},fe={class:"meta-item"},ge={class:"meta-item"},he={class:"articles-header"},we={class:"section-title"},ye={class:"count"},ke={class:"articles-list"},be=["onClick"],xe={key:0,class:"article-cover"},Te=["src","alt"],Ce={class:"article-content"},De={class:"article-top"},Ve={class:"article-title"},Be={class:"article-badges"},ze={class:"article-summary"},Ae={class:"article-meta"},Ne={class:"meta-item"},$e={class:"meta-item"},Fe={class:"meta-item"},Se={class:"section-title"},Ee={class:"related-list"},Re=["onClick"],je={class:"related-content"},Le={class:"related-name"},Me={class:"related-desc"},He={class:"related-stats"},Ie={class:"stat-item"},Ke={class:"stat-value"},Oe={class:"stat-item"},Ue={class:"stat-value"},We={__name:"TagDetail",setup(qe){const T=q(),C=X(),D=b(()=>T.params.slug),v=f("date"),p=f(!0),m=f({id:0,slug:D.value,name:"",description:"",followers:0}),g=f([]),w=f([]),V=async()=>{try{const t=await ne({slug:D.value});if(t){const e=t;m.value={id:e.id,slug:e.slug,name:e.name,description:e.description||e.name+"相关技术文章",followers:0},g.value=[]}else $.error("标签不存在")}catch(t){console.error("加载标签失败:",t),$.error("加载标签失败")}},B=async()=>{try{const t=await ie({page:1,size:10});w.value=(t.list||[]).filter(e=>e.id!==m.value.id).slice(0,4).map(e=>({id:e.id,slug:e.slug,name:e.name,description:e.description||e.name+"相关技术文章",count:0,views:0}))}catch(t){console.error("加载相关标签失败:",t)}};G(async()=>{p.value=!0,await V(),await B(),p.value=!1}),J(()=>T.params.slug,async t=>{t&&(p.value=!0,await V(),await B(),p.value=!1)});const R=b(()=>g.value.reduce((t,e)=>t+e.views,0)),z=b(()=>{const t=[...g.value];return v.value==="date"?t.sort((e,n)=>new Date(n.createdAt)-new Date(e.createdAt)):v.value==="views"?t.sort((e,n)=>n.views-e.views):v.value==="comments"&&t.sort((e,n)=>n.comments-e.comments),t}),y=t=>t>=1e4?(t/1e4).toFixed(1)+"W":t>=1e3?(t/1e3).toFixed(1)+"K":t,j=t=>{C.push(`/article/${t.id}`)},L=t=>{C.push(`/tag/${t.slug}`)};return(t,e)=>{const n=u("el-icon"),M=u("el-button"),k=u("el-option"),H=u("el-select"),A=u("el-tag"),N=u("el-card"),I=u("el-col"),K=u("el-row"),O=Q("loading");return P((r(),_("div",de,[s("div",ce,[s("div",re,[s("div",ue,[a(n,{size:60},{default:o(()=>[a(c(Y))]),_:1})]),s("h1",_e,"# "+i(m.value.name),1),s("p",ve,i(m.value.description),1),s("div",pe,[s("span",me,[a(n,null,{default:o(()=>[a(c(Z))]),_:1}),d(" "+i(g.value.length)+" 篇文章 ",1)]),e[1]||(e[1]=s("span",{class:"divider"},"·",-1)),s("span",fe,[a(n,null,{default:o(()=>[a(c(F))]),_:1}),d(" "+i(y(R.value))+" 阅读 ",1)]),e[2]||(e[2]=s("span",{class:"divider"},"·",-1)),s("span",ge,[a(n,null,{default:o(()=>[a(c(ee))]),_:1}),d(" "+i(m.value.followers)+" 关注 ",1)])]),a(M,{type:"primary",round:"",size:"large",class:"follow-btn"},{default:o(()=>[a(n,null,{default:o(()=>[a(c(se))]),_:1}),e[3]||(e[3]=d(" 关注标签 ",-1))]),_:1})]),e[4]||(e[4]=s("div",{class:"header-bg"},null,-1))]),a(K,{justify:"center",class:"content-wrapper"},{default:o(()=>[a(I,{span:16,xs:22},{default:o(()=>[a(N,{class:"articles-card",shadow:"never"},{default:o(()=>[s("div",he,[s("h3",we,[a(n,null,{default:o(()=>[a(c(te))]),_:1}),e[5]||(e[5]=d(" 全部文章 ",-1)),s("span",ye,"("+i(z.value.length)+")",1)]),a(H,{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=l=>v.value=l),style:{width:"140px"},size:"small"},{default:o(()=>[a(k,{label:"最新发布",value:"date"}),a(k,{label:"最多阅读",value:"views"}),a(k,{label:"最多评论",value:"comments"})]),_:1},8,["modelValue"])]),s("div",ke,[(r(!0),_(S,null,E(z.value,l=>(r(),_("div",{key:l.id,class:"article-item",onClick:U=>j(l)},[l.cover?(r(),_("div",xe,[s("img",{src:l.cover,alt:l.title},null,8,Te)])):h("",!0),s("div",Ce,[s("div",De,[s("h4",Ve,i(l.title),1),s("div",Be,[l.isNew?(r(),x(A,{key:0,type:"success",size:"small",effect:"plain"},{default:o(()=>[...e[6]||(e[6]=[d("新",-1)])]),_:1})):h("",!0),l.isHot?(r(),x(A,{key:1,type:"danger",size:"small",effect:"plain"},{default:o(()=>[...e[7]||(e[7]=[d("热",-1)])]),_:1})):h("",!0)])]),s("p",ze,i(l.summary),1),s("div",Ae,[s("span",Ne,[a(n,null,{default:o(()=>[a(c(ae))]),_:1}),d(" "+i(l.createdAt),1)]),s("span",$e,[a(n,null,{default:o(()=>[a(c(F))]),_:1}),d(" "+i(y(l.views)),1)]),s("span",Fe,[a(n,null,{default:o(()=>[a(c(le))]),_:1}),d(" "+i(l.comments),1)])])])],8,be))),128))])]),_:1}),w.value.length>0?(r(),x(N,{key:0,class:"related-card",shadow:"never"},{default:o(()=>[s("h3",Se,[a(n,null,{default:o(()=>[a(c(oe))]),_:1}),e[8]||(e[8]=d(" 相关标签 ",-1))]),s("div",Ee,[(r(!0),_(S,null,E(w.value,l=>(r(),_("div",{key:l.id,class:"related-item",onClick:U=>L(l)},[s("div",je,[s("div",Le,"# "+i(l.name),1),s("div",Me,i(l.description),1)]),s("div",He,[s("div",Ie,[s("span",Ke,i(l.count),1),e[9]||(e[9]=s("span",{class:"stat-label"},"文章",-1))]),e[11]||(e[11]=s("div",{class:"stat-divider"},null,-1)),s("div",Oe,[s("span",Ue,i(y(l.views)),1),e[10]||(e[10]=s("span",{class:"stat-label"},"阅读",-1))])])],8,Re))),128))])]),_:1})):h("",!0)]),_:1})]),_:1})])),[[O,p.value]])}}},Pe=W(We,[["__scopeId","data-v-ba7c4910"]]);export{Pe as default};
